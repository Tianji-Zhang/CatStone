f = @(i_dim,cell_index)(logical ((var_table(1,cell_index) + (50 .* (1 - var_table(2,cell_index)))) > (var_table(1,adj_index(cell_index,i_dim)) + (50 .* (1 - var_table(2,adj_index(cell_index,i_dim)))))) .* (1 - (var_table(2,cell_index) .^ 0.5)) + (1 - logical ((var_table(1,cell_index) + (50 .* (1 - var_table(2,cell_index)))) > (var_table(1,adj_index(cell_index,i_dim)) + (50 .* (1 - var_table(2,adj_index(cell_index,i_dim))))))) .* (1 - (var_table(2,adj_index(cell_index,i_dim)) .^ 0.5)));